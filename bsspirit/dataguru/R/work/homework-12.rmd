第11周 数据分析与R语言  -- 张丹(24)
========================================================

书面作业 
1-2 薛毅书P557，9.3，9.4(1) 

互动作业 
本周的互动仍以算法和R语言实现为主。 
要求每位同学至少发2篇主题，就算法理论以及在R上的有
关用法进行探讨。发到R中国用户组或数据分析与数据挖掘版。 
另外要求每位同学至少参与5个上述主题的讨论（回帖）。

## 9.3
```{r}
x<- c(1.000, 0.846, 0.805, 0.859, 0.473, 0.398, 0.301, 0.382,
      0.846, 1.000, 0.881, 0.826, 0.376, 0.326, 0.277, 0.277, 
      0.805, 0.881, 1.000, 0.801, 0.380, 0.319, 0.237, 0.345, 
      0.859, 0.826, 0.801, 1.000, 0.436, 0.329, 0.327, 0.365, 
      0.473, 0.376, 0.380, 0.436, 1.000, 0.762, 0.730, 0.629, 
      0.398, 0.326, 0.319, 0.329, 0.762, 1.000, 0.583, 0.577, 
      0.301, 0.277, 0.237, 0.327, 0.730, 0.583, 1.000, 0.539, 
      0.382, 0.415, 0.345, 0.365, 0.629, 0.577, 0.539, 1.000)
names<-c("x1", "x2", "x3", "x4", "x5", "x6", "x7", "x8")
# names<=c("身高","手臂长","上肢长","下肢长","体重","颈围","胸围","胸宽")
R<-matrix(x, nrow=8, dimnames=list(names, names))
```

### 方法一：使用factanal的极大似然法，对2个因子进行分析。
factor1的"身高","手臂长","上肢长","下肢长"是趋近于1的，这些描述是身高特征。
factor2的"体重"是趋近于1的，描述了体重的特征。

```{r}
fa2<-factanal(factors=2,covmat=R);fa2
```

### 方法二：使用书中的主成法，对2个因子进行分析。
factor1的"身高","手臂长","上肢长","下肢长"是趋近于1的，这些描述是<b>身高</b>特征。
factor2的"体重","颈围","胸围","胸宽"是比较大，描述了<b>体重</b>的特征。
```{r}
source("factor.analy.R")
fa<-factor.analy(R,m=2,method="princomp")
vm<-varimax(fa$loadings,normalize=FALSE);vm
```

### 方法三：使用psych包的fa方法，主成法
```{r}
library(psych)
fa<-fa(R,nfactors=2,rotate="varimax",fm="pa" );fa
factor.plot(fa,labels=rownames(fa$loadings))
```
### 三种方法结果类似！！使用psych包，更灵活一些。

## 9.4(1)

```{r}
dat = read.table(textConnection(
  'X1  X2  X3  X4  X5
1  99  94  93 100 100
2  99  88  96  99  97
3 100  98  81  96 100
4  93  88  88  99  96
5 100  91  72  96  78
6  90  78  82  75  97
7  75  73  88  97  89
8  93  84  83  68  88
9  87  73  60  76  84
10  95  82  90  62  39
11  76  72  43  67  78
12  85  75  50  34  37'), header = TRUE)

# names<=c("政治","语文","外语","数学","物理")
```
### 使用factanal的极大似然法，对2个因子进行分析。
factor1的"政治","语文"是趋近于1的，这些描述是 <b>文科</b> 特征。
factor2的"数学","物理"是趋近于1的，这些描述是 <b>理科</b> 特征。

```{r}
fa<-factanal(~., factors=2, data=dat);fa
```


