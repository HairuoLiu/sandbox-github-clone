#9.1
data<-data.frame(
  x1=c(90342,4903,6735,49454,139190,12215,2372,11062,17111,1206,2150,5251,14341),
  x2=c(52455,1973,21139,36241,203505,16219,6572,23078,23907,3930,5704,6155,13203),
  x3=c(101091,2035,3767,81557,215898,10351,8103,54935,52108,6126,6200,10383,19396),
  x4=c(19272,10313,1780,22504,10609,6382,12329,23804,21796,15586,10870,16875,14961),
  x5=c(82.0,34.2,36.1,98.1,93.2,62.5,184.4,370.4,221.5,330.4,184.2,146.4,94.6),
  x6=c(16.1,7.1,8.2,25.9,12.6,8.7,22.2,41.0,21.5,29.5,12.0,27.5,17.8),
  x7=c(197435,592077,726396,348226,139572,145818,20921,65486,63806,1840,8913,78796,6354),
  x8=c(0.172,0.003,0.003,0.985,0.628,0.066,0.152,0.263,0.276,0.437,0.274,0.151,1.574)
)

prin<-princomp(data,cor=TRUE)
summary(prin,loadings=TRUE)
screeplot(prin,type='lines')

loading<-loadings(prin)

pre<-predict(prin)
#clustor
h<-hclust(dist(pre[,1:3]),"ward")
plot(h)

k<-kmeans(pre[,1:3],4)
library(cluster) 
clusplot(pre, k$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)
library(fpc)
plotcluster(pre, k$cluster)

#sort
arr<-cbind(c(1:13),pre[,1],pre[,2],pre[,3])
print(arr[order(-arr[,2]),][,1])
print(arr[order(-arr[,3]),][,1])
print(arr[order(-arr[,4]),][,1])



# plot(loading[,1:2])
# text(loading[,1],loading[,2],adj=c(-0.4,0.3))

# z1<-(-0.476)*x1+(-0.472)*x2+(-0.423)*x3+(0.214)*x4+(0.389)*x5+(0.353)*x6+(-0.216)*x7
# z2<-(-0.297)*x1+(-0.279)*x2+(-0.379)*x3+(-0.451)*x4+(-0.329)*x5+(-0.401)*x6+(0.377)*x7+(-0.275)*x8
# z3<-(-0.104)*x1+(-0.166)*x2+(-0.157)*x3+(-0.328)*x5+(-0.147)*x6+(-0.129)*x7+(0.889)*x8

