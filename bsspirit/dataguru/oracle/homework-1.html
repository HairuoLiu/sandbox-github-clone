<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Oracle 第一周作业 - 张丹(15)</title>

<base target="_blank"/>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
}

pre code {
   display: block; padding: 0.5em;
}

code.r {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>





</head>

<body>
<h1>Oracle 第一周作业 - 张丹(15)</h1>

<p>阅读作业 本节课没有书面阅读,大家有兴趣可以去找一些大树据相关的资料阅读. </p>

<p>书面作业<br/>
1.你心中的大数据是什么样的? <br/>
2.搭建一个测试环境，作行，列数据库的性能比较(数据库可以选择Oracle和sybase iq，自己定义几种类型的SQL查询). <br/>
3.你对RDBMS和NOSQL的将来，有什么看法？ </p>

<p>互动作业<br/>
请所有的学员都在炼数成金网站（<a href="http://f.dataguru.cn%EF%BC%89%E6%B3%A8%E5%86%8C%E8%B4%A6%E5%8F%B7%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%9C%A8%E2%80%9C%E7%9C%9F%E5%AE%9E%E5%A7%93%E5%90%8D%E2%80%9D%E5%B1%9E%E6%80%A7%E9%A1%B9%E5%A1%AB%E5%86%99%E2%80%9Cora-nn%E2%80%9D%E7%9A%84%E5%AD%97%E6%A0%B7%EF%BC%88%E6%AD%A4%E5%A4%84nn%E4%BB%A3%E8%A1%A8%E5%88%86%E9%85%8D%E7%9A%84%E5%AD%A6%E5%8F%B7%EF%BC%89%EF%BC%8C%E4%BD%BF%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%9C%A8%E5%85%AC%E4%BC%97%E7%94%A8%E6%88%B7%E4%B8%AD%E8%AF%86%E5%88%AB%E5%87%BA%E5%AD%A6%E5%91%98%E3%80%82">http://f.dataguru.cn）注册账号，并且在“真实姓名”属性项填写“ora-nn”的字样（此处nn代表分配的学号），使我们可以在公众用户中识别出学员。</a> 要求大家在本周参与“相关IT支撑技术”板块（讨论数据库相关技术）,&ldquo;关系型数据库数据分析&rdquo;(OLAP相关技术的讨论)的互动。每位学员至少以主题帖的形式提出2个问题（或讨论话题）然后至少参加5个上述主题的讨论（回帖形式）。 本周的网络互动属于适应期，暂时不进行核查和扣罚。</p>

<hr/>

<p>1.你心中的大数据是什么样的? <br/>
大数据包括二类, 一类是人的数据, 比如一个人衣食住行,吃乐玩喝,在海量用户的时数据量是无法想像的.<br/>
第二类是所有非人类制造的数据,比如x光片,物联网,卫星等,这些数据和人类制造数据再进行交叉,在海量用户和海量机器的情况下,这样规模数据的数量级,远远超过现在所有存储设备容量总和.</p>

<p>2.搭建一个测试环境，作行，列数据库的性能比较(数据库可以选择Oracle和sybase iq，自己定义几种类型的SQL查询). </p>

<p>测试环境MySQL的MyISAM行式数据库引擎和InfoBright的brightHouse列式数据库引擎.<br/>
本机系统：普通台式机，2CPU，2G内存，硬盘5400转，Linux Ubuntu 12.04 32位<br/>
InfoBright按最小默认配置my-ib.cnf<br/>
 [mysqld]<br/>
 27 port        = 5029<br/>
 28 socket      = /tmp/mysql-ib.sock<br/>
 29 skip-locking<br/>
 30 key_buffer = 16M<br/>
 31 max_allowed_packet = 500M<br/>
 32 table_cache = 16<br/>
 33 sort_buffer_size = 1M<br/>
 34 read_buffer_size = 1M<br/>
 35 read_rnd_buffer_size = 4M<br/>
 36 myisam_sort_buffer_size = 8M<br/>
 37 net_buffer_length = 8K<br/>
 38 thread_cache_size = 32<br/>
 39 thread_stack = 512K<br/>
 40 query_cache_size = 8M<br/>
 41 query_cache_type=0<br/>
 42 # Try number of CPU cores*4 for thread_concurrency<br/>
 43 thread_concurrency = 8</p>

<p>数据结构DDL：<br/>
CREATE TABLE t_user_myISAM(<br/>
    id INT,<br/>
    name varchar(32) NOT NULL ,<br/>
    create_date TIMESTAMP NULL  DEFAULT now()<br/>
)ENGINE=MyISAM DEFAULT CHARSET=utf8;</p>

<p>CREATE TABLE t_user_righthouse(<br/>
    id INT,<br/>
    name varchar(32) NOT NULL ,<br/>
    create_date TIMESTAMP NULL  DEFAULT now()<br/>
)ENGINE=Brighthouse DEFAULT CHARSET=utf8;</p>

<p>数据样本：<br/>
tail -f /tmp/myisam.csv <br/>
14999990,14999990&ndash;14999990,2012-07-05 16:56:54<br/>
14999991,14999991&ndash;14999991,2012-07-05 16:56:54<br/>
14999992,14999992&ndash;14999992,2012-07-05 16:56:54<br/>
14999993,14999993&ndash;14999993,2012-07-05 16:56:54<br/>
14999994,14999994&ndash;14999994,2012-07-05 16:56:54<br/>
14999995,14999995&ndash;14999995,2012-07-05 16:56:54<br/>
14999996,14999996&ndash;14999996,2012-07-05 16:56:54<br/>
14999997,14999997&ndash;14999997,2012-07-05 16:56:54<br/>
14999998,14999998&ndash;14999998,2012-07-05 16:56:54<br/>
14999999,14999999&ndash;14999999,2012-07-05 16:56:54</p>

<p>存储比较：数据量分别为50W条，500W条，2500W条<br/>
第一行为原始CSV,第二行为tar.gz压缩的CSV，t_user_myISAM.MYD为MyISAM引擎存储的数据文件，t_user_righthouse.bht是</p>

<p>#50w<br/>
-rw-rw-rw- 1 mysql mysql 20666643  7月  5 16:03 /tmp/myisam.csv<br/>
-rw-rw-r&ndash; 1 mysql mysql  3640018  7月  5 16:20 /tmp/myisam.tar.gz<br/>
-rwxr-xr-x 1 mysql mysql     8630  7月  5 15:32 t_user_myISAM.frm*<br/>
-rwxr-xr-x 1 mysql mysql 13959580  7月  5 15:32 t_user_myISAM.MYD*<br/>
-rwxr-xr-x 1 mysql mysql     1024  7月  5 15:32 t_user_myISAM.MYI*</p>

<p>#500w<br/>
-rw-rw-rw- 1 mysql mysql 221666643  7月  5 16:32 /tmp/myisam.csv<br/>
-rw-rw-r&ndash; 1 conan conan  36877526  7月  5 16:33 /tmp/myisam.tar.gz<br/>
-rw-rw&mdash;- 1 mysql mysql      8630  7月  5 16:24 t_user_myISAM.frm<br/>
-rw-rw&mdash;- 1 mysql mysql 155959580  7月  5 16:30 t_user_myISAM.MYD<br/>
-rw-rw&mdash;- 1 mysql mysql      1024  7月  5 16:30 t_user_myISAM.MYI</p>

<p>#2500w<br/>
-rw-rw-rw- 1 mysql mysql 908333286  7月  5 16:58 /tmp/myisam.csv<br/>
-rw-rw-r&ndash; 1 conan conan 147507267  7月  5 16:59 /tmp/myisam.tar.gz<br/>
-rw-rw&mdash;- 1 mysql mysql      8630  7月  5 16:24 t_user_myISAM.frm<br/>
-rw-rw&mdash;- 1 mysql mysql 631919160  7月  5 16:56 t_user_myISAM.MYD<br/>
-rw-rw&mdash;- 1 mysql mysql      1024  7月  5 16:56 t_user_myISAM.MYI<br/>
drwxrwx&ndash;x 2 mysql mysql      4096  7月  5 17:01 t_user_righthouse.bht/<br/>
-rw-rw&mdash;- 1 mysql mysql      8630  7月  5 16:24 t_user_righthouse.frm<br/>
#打开t_user_righthouse.bht/目录<br/>
drwxr-xr-x 2 mysql mysql      4096  7月  5 17:01 ./<br/>
drwxr-xr-x 3 mysql mysql      4096  7月  5 16:24 ../<br/>
-rw-rw&mdash;- 1 mysql mysql         0  7月  5 17:01 ab_switch<br/>
-rw-rw&mdash;- 1 mysql mysql     15344  7月  5 17:01 TA00000000000000.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql      5616  7月  5 16:34 TA00000000000001.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql       117  7月  5 16:34 TA00000.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql     14171  7月  5 17:01 TA00000DPN.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql 126449126  7月  5 17:01 TA00001000000000.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql  31428144  7月  5 16:34 TA00001000000001.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql       103  7月  5 16:34 TA00001.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql     14171  7月  5 17:01 TA00001DPN.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql     16962  7月  5 17:01 TA00002000000000.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql      6015  7月  5 16:34 TA00002000000001.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql       126  7月  5 16:34 TA00002.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql     14171  7月  5 17:01 TA00002DPN.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql        65  7月  5 16:24 Table.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql       117  7月  5 17:01 TB00000.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql       103  7月  5 17:01 TB00001.ctb<br/>
-rw-rw&mdash;- 1 mysql mysql       126  7月  5 17:01 TB00002.ctb</p>

<p>数据存储总结：brighthouse的列式引擎的压缩比，真是相当的高啊！</p>

<p>数据行    csv   csv.tar.gz    MyISAM     brighthouse<br/><br/>
50w       20m      3m           14m<br/>
500w      222m    37m          156m<br/>
2500w     908m    147m         623m         159m    </p>

<p>数据查询(2500w)：无索引！<br/>
SELECT * FROM infobright.t_user_myISAM <br/>
where create_date&lt;&#39;2012-07-05 16:26:32&#39; limit 1000000,100; <br/>
时间&gt;30s</p>

<p>SELECT * FROM infobright.t_user_righthouse <br/>
where create_date&lt;&#39;2012-07-05 16:26:32&#39; limit 1000000,100;<br/>
时间&lt;1s</p>

<p>SELECT count(id) FROM infobright.t_user_myISAM <br/>
where create_date&lt;&#39;2012-07-05 16:26:32&#39;;<br/>
时间&gt;30s</p>

<p>SELECT count(id) FROM infobright.t_user_righthouse <br/>
where create_date&lt;&#39;2012-07-05 16:26:32&#39;;<br/>
时间&lt;1s</p>

<p>如此可以，brighthouse引擎查询是很快的,远优于无索引的MyIASM。</p>

<p>在t_user_myISAM表创建索引：<br/>
CREATE INDEX t_user_myISAM_IDX_1 on t_user_myISAM(id);</p>

<p>-rw-rw&mdash;- 1 mysql mysql      8630  7月  6 10:52 t_user_myISAM.frm<br/>
-rw-rw&mdash;- 1 mysql mysql 631919160  7月  6 10:53 t_user_myISAM.MYD<br/>
-rw-rw&mdash;- 1 mysql mysql 226201600  7月  6 10:54 t_user_myISAM.MYI<br/>
索引占用空间226m</p>

<p>mysql&gt; SELECT count(id) FROM infobright.t_user_myISAM where id&lt;15484646;<br/>
+&mdash;&mdash;&mdash;&ndash;+<br/>
| count(id) |<br/>
+&mdash;&mdash;&mdash;&ndash;+<br/>
|  19999998 |<br/>
+&mdash;&mdash;&mdash;&ndash;+<br/>
1 row in set (16.17 sec)</p>

<p>mysql&gt; explain SELECT count(id) FROM infobright.t_user_myISAM  where id&lt;15484646;<br/>
+&mdash;-+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+<br/>
| id | select_type | table         | type  | possible_keys       | key                 | key_len | ref  | rows     | Extra                    |<br/>
+&mdash;-+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+<br/>
|  1 | SIMPLE      | t_user_myISAM | index | t_user_myISAM_IDX_1 | t_user_myISAM_IDX_1 | 5       | NULL | 19999998 | Using where; Using index |<br/>
+&mdash;-+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+<br/>
1 row in set (0.01 sec)</p>

<p>按索引的查询，需要16.17s</p>

<p>mysql&gt; SELECT count(id) FROM infobright.t_user_righthouse  where id&lt;15484646;<br/>
+&mdash;&mdash;&mdash;&ndash;+<br/>
| count(id) |<br/>
+&mdash;&mdash;&mdash;&ndash;+<br/>
|  24999997 |<br/>
+&mdash;&mdash;&mdash;&ndash;+<br/>
1 row in set (0.00 sec)</p>

<p>mysql&gt; explain SELECT count(id) FROM infobright.t_user_righthouse  where id&lt;15484646;<br/>
+&mdash;-+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+<br/>
| id | select_type | table             | type | possible_keys | key  | key_len | ref  | rows     | Extra                             |<br/>
+&mdash;-+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+<br/>
|  1 | SIMPLE      | t_user_righthouse | ALL  | NULL          | NULL | NULL    | NULL | 24999997 | Using where with pushed condition |<br/>
+&mdash;-+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+<br/>
1 row in set (0.00 sec)</p>

<p>索引总结：即使使用MyISAM的索引查询，对于2500W条数据来说，也不如brighthouse的无索引ALL查询。我们真应该在适合的时间，适合的地点，把列式数据库应用起来！！</p>

<p>3.你对RDBMS和NOSQL的将来，有什么看法？<br/>
首先, RDBMS与NOSQL都在发展, 都有各自的使用领域, 会一直并存下去.<br/>
从应用角度, RDBMS偏向于设计,对于像软件应用,ERP系统等, 业务需求稳定的系统来说, RDBMS会一直是主流.<br/>
对于快速原型,快速实现,需求天天变的互联网应用来说,NoSQL是让开发人员少加班的利器.</p>

<p>也许未来,NoSQL会更专业化, 就像Neo4j一样&hellip;一种领域,一种数据库. <br/>
而对于RDBMS把基础数据类型,基础功能完善好,其实就足够了.当然,如果能在RDBMS里,定义NoSQL的类型字段,那么RBDMS又将统一天下了!</p>

</body>

</html>

