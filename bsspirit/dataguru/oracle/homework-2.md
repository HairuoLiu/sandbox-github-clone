Oracle 第二周作业 - 张丹(15)
======================================================== 
阅读作业 本节课没有书面阅读,大家有兴趣可以去找一些CAP相关的资料阅读. 

书面作业 
1.谈谈你是如何理解ACID的? 
2.设计3种架构体系,让他们分别满足CAP理论的CA架构,AP架构和CP架构. 
3.描述一种你认为最适用于最终一致性的系统架构(现实中的应用). 
4.在PPT里谈到的分布式Oracle数据库中,你认为中间件最核心作用是什么? 


互动作业 

请所有的学员都在炼数成金网站（http://f.dataguru.cn）注册账号，并且在“真实姓名”属性项填写“ora-nn”的字样（此处nn代表分配的学号），使我们可以在公众用户中识别出学员。 要求大家在本周参与“相关IT支撑技术”板块（讨论数据库相关技术）,"关系型数据库数据分析"(OLAP相关技术的讨论)的互动。每位学员至少以主题帖的形式提出2个问题（或讨论话题）然后至少参加5个上述主题的讨论（回帖形式）。 本周的网络互动属于适应期，暂时不进行核查和扣罚。

------------------------------------------------
1.谈谈你是如何理解ACID的? 
ACID是关系型数据库中，事务的4个特性。
通过ACID保证了RDBMS数据库的操作是可靠的，安全的，稳定的。
如果使用支持ACID的RDBMS来说，我们一般不会考虑数据丢失，数据不完整，因为ACID保证了这一切。
对使用者来说，交给ACID黑盒处理，一切就简单了。
如果没有事务的保证，让开发人员自己控制这一切，将是一场灾难！


2.设计3种架构体系,让他们分别满足CAP理论的CA架构,AP架构和CP架构. 
CA：选择AC，为了保证可用，数据必须要有复制。这样系统会无法使用分区容忍性。当同一数据的两个副本分配到了两个无法通信的分区上时，显然会返回错误的数据。
应用实例：MySQL的集群系统（复制＋事务）

CP：选择CP，那么即使坏了节点，操作必须又一致，又能顺利完成。所以就要100%保证所有节点之间有很好的连通性。这是很难做到的。最好的办法就是将所有数据放到同一个节点中。因此，这种设计是不能满足Ａ的。
应用实例：多点读取R=N

AP: 选择AP，要满足可用性，就说明数据必须要在不同节点有复制。然后还必须保证在产生分区的时候仍然操作可以完成。那么，必然操作无法保证一致性。
应用实例：单点取读R=1，最终一致性


3.描述一种你认为最适用于最终一致性的系统架构(现实中的应用). 
集中式数据库：
4台数据作为一组服务器，1主3从(集群数据复制)，每次只写一个库，读一个库。
读写分离：1台读写，3台只读。WR，R1，R2，R3
一般情况下，数据复制会有1-2秒延迟。
如果写库WR坏了
1)如果写库WR坏了，切换一台读库R1为读写库，1主2从。
2)重起WR，找到未同步的数据，把未同步的数据同步给原3从，R1,R2,R3。
3)一台R3读库做增量数据导出新数据(锁表)，为WR恢复数据。
4)WR作为R1的从库重新上线，又还原到出初始的1主３从设置。
数据最终保持一致性。

分布式数据库：
4台数据作为一组服务器，2个读写库，２个读库。
基于NWR理论的最终一致性的系统架构，W＝2，R＝1，N＝4, W+R<N
组合单调读一致性和读己之所写一致性，通过读取自己更新的数据，和一旦读取到最新的版本不会再读取旧版本，对于此架构上的程序开发来说，会少很多额外的烦恼。


4.在PPT里谈到的分布式Oracle数据库中,你认为中间件最核心作用是什么?
最核心的作用应该是简化操作。
中间件层包括：负载均衡，并行查询，统一API，数据库监控，数据加载，容错和扩展。
如果这些功能让每个应用都自己去实现，开发人员，运维人员，DBA，天天加班也干不完这些活的，而且这些应用难度很高，很难有人能胜任这项工作。



